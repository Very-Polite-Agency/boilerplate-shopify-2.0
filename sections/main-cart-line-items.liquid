{%- liquid

  assign section_name = 'cart-line-items'
  assign section_classes = section_name
  assign section_id = section_name | append: '--' | append: section.id

  assign aos_delay = 250
  assign aos_delay_increment = 250
  assign aos_id = section_id

  assign section_container = section.settings.container
  assign section_empty_cart_message = settings.cart_empty_message | default: '<p>Oops! Nothing added to your cart yet :(</p>'

  assign section_form_action = routes.cart_url
  assign section_form_id = section_name | append: '__line-items'

  assign section_line_item_image_aspect_ratio_desktop = section.settings.line_item_image_aspect_ratio_desktop | default: ''
  assign section_line_item_image_aspect_ratio_mobile = section.settings.line_item_image_aspect_ratio_mobile | default: ''
  assign section_line_item_padding_bottom = section.settings.line_item_padding_bottom
  assign section_line_item_padding_top = section.settings.line_item_padding_top

-%}

{%- style -%}

  #{{ section_id }} .cart-line-item {
    padding-top: calc({{ section_line_item_padding_top }}px * 0.75);
  }

  #{{ section_id }} .cart-line-item {
    padding-bottom: calc({{ section_line_item_padding_bottom }}px  * 0.75);
  }

  {% if section_line_item_image_aspect_ratio_mobile and section_line_item_image_aspect_ratio_mobile != blank %}
    #{{ section_id }} .cart-line-item__image {
      aspect-ratio: {{ section_line_item_image_aspect_ratio_mobile }};
    }
  {% endif %}

  @media screen and (min-width: 992px) {

    #{{ section_id }} .cart-line-item {
      padding-top: {{ section_line_item_padding_top }}px;
    }

    #{{ section_id }} .cart-line-item {
      padding-bottom: {{ section_line_item_padding_bottom }}px;
    }

    {% if section_line_item_image_aspect_ratio_desktop and section_line_item_image_aspect_ratio_desktop != blank %}
      #{{ section_id }} .cart-line-item__image {
        aspect-ratio: {{ section_line_item_image_aspect_ratio_desktop }};
      }
    {% endif %}
  }

  {%-
    render 'element-styles',
      background: section.settings.background,
      background_image: section.settings.background_image,
      background_image_position_desktop: section.settings.background_image_position_desktop,
      background_image_position_mobile: section.settings.background_image_position_mobile,
      background_image_repeat: section.settings.background_image_repeat,
      background_image_size: section.settings.background_image_size,
      border_bottom: section.settings.border_bottom,
      border_top: section.settings.border_top,
      id: section_id,
  -%}

{%- endstyle -%}

<div class="{{ section_classes }}" id="{{ section_id }}">

  <div class="{{ section_name }}__main">
    {% render 'bs-container', state: 'open', col: 'col-12', container: section_container %}
      <div class="{{ section_name }}__main-content">
        <form class="{{ section_form_id }} js--cart" id="{{ section_form_id }}" action="{{ section_form_action }}" method="post">
          {%- for item in cart.items -%}
            {%- capture snippet_classes -%}{{ section_name }}__line-item{%- endcapture -%}
            {%- render 'cart-line-item', cart_line_item_classes: snippet_classes, cart_line_item_index: forloop.index, cart_line_item: item -%}
          {%- else -%}
             <div class='cart-empty-message'>
              <div class='cart-empty-message__content body-copy--primary body-copy--2'>{{ section_empty_cart_message }}</div>
            </div>
          {%- endfor -%}
        </form>
      </div>
    {% render 'bs-container', state: 'closed', col: 'col-12', container: section_container %}
  </div>

  <div class="{{ section_name }}__footer">
    {% render 'bs-container', state: 'open', col: 'col-12', container: section_container %}
      <div class="{{ section_name }}__footer-content">

        <div class="{{ section_name }}__cart-subtotal body-copy--secondary body-copy--1 text--uppercase">
          <div class="{{ section_name }}__cart-subtotal-label">Subtotal</div>
          <div class="{{ section_name }}__cart-subtotal-value js--cart-subtotal">{{ cart.items_subtotal_price | money_with_currency }}</div>
        </div>

        <div class="{{ section_name }}__actions">
          <div class="{{ section_name }}__actions-message body-copy--primary body-copy--1">
            <p><a href="/collections" target="_self" title="Continue Shopping">Continue shopping</a> or</p>
          </div>
          <button class="{{ section_name }}__button-checkout button--svg button--svg-fill-orange" form="{{ section_form_id }}" name="checkout" type="submit" value="Checkout">
            {% render 'svg-button', type: 'checkout.md' %}
          </button>
        </div>

      </div>
    {% render 'bs-container', state: 'closed', col: 'col-12', container: section_container %}
  </div>

</div>

{% schema %}
{
  "name": "Cart | Line Items",
  "tag": "section",
  "class": "section section--cart-line-items",
  "enabled_on": {
    "templates": ["cart"]
  },
  "settings": [
    {
      "content": "Settings",
      "type": "header"
    },
    {
      "label": "Background",
      "type": "select",
      "options": [
        { "label": "Image", "value": "image" },
        { "label": "Lemon", "value": "lemon" },
        { "label": "Lime", "value": "lime" },
        { "label": "Mango", "value": "mango" },
        { "label": "Orange", "value": "orange" },
        { "label": "Strawberry", "value": "strawberry" },
        { "label": "White", "value": "white" }
      ],
      "default": "white",
      "id": "background"
    },
    {
      "label": "Background Image",
      "type": "image_picker",
      "id": "background_image"
    },
    {
      "label": "Background Image Position (Mobile)",
      "type": "select",
      "options": [
        { "label": "Top Left", "value": "top left" },
        { "label": "Top Center", "value": "top center" },
        { "label": "Top Right", "value": "top right" },
        { "label": "Center Left", "value": "center left" },
        { "label": "Center Center", "value": "center center" },
        { "label": "Center Right", "value": "center right" },
        { "label": "Bottom Left", "value": "bottom left" },
        { "label": "Bottom Center", "value": "bottom center" },
        { "label": "Bottom Right", "value": "bottom right" }
      ],
      "default": "center center",
      "id": "background_image_position_mobile"
    },
    {
      "label": "Background Image Position (Desktop)",
      "type": "select",
      "options": [
        { "label": "Top Left", "value": "top left" },
        { "label": "Top Center", "value": "top center" },
        { "label": "Top Right", "value": "top right" },
        { "label": "Center Left", "value": "center left" },
        { "label": "Center Center", "value": "center center" },
        { "label": "Center Right", "value": "center right" },
        { "label": "Bottom Left", "value": "bottom left" },
        { "label": "Bottom Center", "value": "bottom center" },
        { "label": "Bottom Right", "value": "bottom right" }
      ],
      "default": "center center",
      "id": "background_image_position_desktop"
    },
    {
      "label": "Background Image Repeat",
      "type": "select",
      "options": [
        { "label": "No Repeat", "value": "no-repeat" },
        { "label": "Repeat", "value": "repeat" }
      ],
      "default": "no-repeat",
      "id": "background_image_repeat"
    },
    {
      "label": "Background Image Size",
      "type": "select",
      "options": [
        { "label": "100px", "value": "100px" },
        { "label": "200px", "value": "200px" },
        { "label": "300px", "value": "300px" },
        { "label": "400px", "value": "400px" },
        { "label": "500px", "value": "500px" },
        { "label": "Auto", "value": "auto" },
        { "label": "Contain", "value": "contain" },
        { "label": "Cover", "value": "cover" }
      ],
      "default": "cover",
      "id": "background_image_size"
    },
    {
      "content": "Border",
      "type": "header"
    },
    {
      "label": "Top Border",
      "type": "checkbox",
      "default": false,
      "id": "border_top"
    },
    {
      "label": "Bottom Border",
      "type": "checkbox",
      "default": false,
      "id": "border_bottom"
    },
    {
      "content": "Container",
      "type": "header"
    },
    {
      "label": "Container",
      "type": "select",
      "options": [
        { "label": "Static", "value": "container" },
        { "label": "Fluid", "value": "container-fluid" },
        { "label": "Full Width", "value": "full-width" }
      ],
      "default": "container",
      "id": "container"
    },
    {
      "content": "Line Item",
      "type": "header"
    },
    {
      "label": "Image Aspect Ratio (Mobile)",
      "info": "Optionally include an aspect ratio for the product images for consistent user experience on smaller devices.",
      "type": "text",
      "id": "line_item_image_aspect_ratio_mobile"
    },
    {
      "label": "Image Aspect Ratio (Desktop)",
      "info": "Optionally include an aspect ratio for the product images for consistent user experience on larger devices.",
      "type": "text",
      "id": "line_item_image_aspect_ratio_desktop"
    },
    {
      "label": "Top Padding",
      "type": "range",
      "min": 20,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24,
      "id": "line_item_padding_top"
    },
    {
      "label": "Bottom Padding",
      "type": "range",
      "min": 20,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24,
      "id": "line_item_padding_bottom"
    }
  ],
  "blocks": []
}
{% endschema %}
